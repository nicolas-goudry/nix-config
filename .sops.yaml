# Get a user key from PGP
# gpg --show-keys <pgp-key> | awk '{ print $1 }' | head -n2 | tail -n1

# Generate a host key
# sudo nix run 'nixpkgs#ssh-to-pgp' -- -i /etc/ssh/ssh_host_rsa_key -o /dev/null

# Add secrets
# nix run 'nixpkgs#sops' -- <path-to-secret>

# If keys defined here were to change, update the secrets with the following command:
# for secret in $(find . -type f -name 'secrets.y*ml'); do nix run 'nixpkgs#sops' -- updatekeys $secret; done
keys:
  users:
    - &nicolas 21B6A59A4E890B1B83E30CDB01C88C0354509AA9
  hosts:
    - &g-xps bf1db49023d416a996b8e227253fd37f56b98b99
creation_rules:
  - path_regex: secrets.ya?ml$
    key_groups:
      - pgp:
          - *g-xps
          - *nicolas
